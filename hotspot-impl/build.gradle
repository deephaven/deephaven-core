plugins {
    id 'io.deephaven.project.register'
}

description 'Implementation for the HotSpot service to obtain JVM instrospection data.'

dependencies {
    implementation project(':hotspot')
    compileOnly libs.autoservice
    annotationProcessor libs.autoservice.compiler
}

tasks.withType(JavaCompile).configureEach {
    options.compilerArgs += ['--add-exports', 'java.management/sun.management=ALL-UNNAMED']
    // Explicitly unset release so gradle will invoke javac with `-source <languageLevel> -target <languageLevel>`
    // instead of `--release <languageLevel>`, which would otherwise produce
    // > error: exporting a package from system module java.management is not allowed with --release
    options.release.unset()
}

tasks.withType(Javadoc).configureEach {
    options.addStringOption('-add-exports', 'java.management/sun.management=ALL-UNNAMED')
}
